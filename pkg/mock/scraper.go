package mock

import "github.com/oslokommune/okctl/pkg/credentials/aws/scrape"

type scraper struct {
	ScrapeFn func(string, string, string) (string, error)
}

// Scrape invokes the mocked scrape function
func (s *scraper) Scrape(username, password, mfaToken string) (string, error) {
	return s.ScrapeFn(username, password, mfaToken)
}

// NewGoodScraper returns a scraper that will succeed
func NewGoodScraper() scrape.Scraper {
	return &scraper{
		ScrapeFn: func(string, string, string) (string, error) {
			// nolint: lll
			return "PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iCiAgICAgICAgICAgICAgICBEZXN0aW5hdGlvbj0iaHR0cHM6Ly9zaWduaW4uYXdzLmFtYXpvbi5jb20vc2FtbCIgSUQ9InJlZGFjdGVkIgogICAgICAgICAgICAgICAgSXNzdWVJbnN0YW50PSIyMDIxLTAyLTE2VDA3OjU2OjIwLjg4NVoiIFZlcnNpb249IjIuMCI+CiAgICA8c2FtbDpJc3N1ZXI+aHR0cHM6Ly9sb2dpbi5vc2xvLmtvbW11bmUubm8vYXV0aC9yZWFsbXMvQUQ8L3NhbWw6SXNzdWVyPgogICAgPGRzaWc6U2lnbmF0dXJlIHhtbG5zOmRzaWc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPgogICAgICAgIDxkc2lnOlNpZ25lZEluZm8+CiAgICAgICAgICAgIDxkc2lnOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz4KICAgICAgICAgICAgPGRzaWc6U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjcnNhLXNoYTI1NiIvPgogICAgICAgICAgICA8ZHNpZzpSZWZlcmVuY2UgVVJJPSIjSURfMWYxZDYxNjAtMGIzOC00NTBlLWIxNzQtMGQzODRhMzEyYmNjIj4KICAgICAgICAgICAgICAgIDxkc2lnOlRyYW5zZm9ybXM+CiAgICAgICAgICAgICAgICAgICAgPGRzaWc6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz4KICAgICAgICAgICAgICAgICAgICA8ZHNpZzpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz4KICAgICAgICAgICAgICAgIDwvZHNpZzpUcmFuc2Zvcm1zPgogICAgICAgICAgICAgICAgPGRzaWc6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+CiAgICAgICAgICAgICAgICA8ZHNpZzpEaWdlc3RWYWx1ZT5yZWRhY3RlZDwvZHNpZzpEaWdlc3RWYWx1ZT4KICAgICAgICAgICAgPC9kc2lnOlJlZmVyZW5jZT4KICAgICAgICA8L2RzaWc6U2lnbmVkSW5mbz4KICAgICAgICA8ZHNpZzpTaWduYXR1cmVWYWx1ZT4KICAgICAgICAgICAgcmVkYWN0ZWQKICAgICAgICA8L2RzaWc6U2lnbmF0dXJlVmFsdWU+CiAgICAgICAgPGRzaWc6S2V5SW5mbz4KICAgICAgICAgICAgPGRzaWc6S2V5TmFtZT5yZWRhY3RlZDwvZHNpZzpLZXlOYW1lPgogICAgICAgICAgICA8ZHNpZzpYNTA5RGF0YT4KICAgICAgICAgICAgICAgIDxkc2lnOlg1MDlDZXJ0aWZpY2F0ZT4KICAgICAgICAgICAgICAgICAgICByZWRhY3RlZAogICAgICAgICAgICAgICAgPC9kc2lnOlg1MDlDZXJ0aWZpY2F0ZT4KICAgICAgICAgICAgPC9kc2lnOlg1MDlEYXRhPgogICAgICAgICAgICA8ZHNpZzpLZXlWYWx1ZT4KICAgICAgICAgICAgICAgIDxkc2lnOlJTQUtleVZhbHVlPgogICAgICAgICAgICAgICAgICAgIDxkc2lnOk1vZHVsdXM+CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZGFjdGVkCiAgICAgICAgICAgICAgICAgICAgPC9kc2lnOk1vZHVsdXM+CiAgICAgICAgICAgICAgICAgICAgPGRzaWc6RXhwb25lbnQ+cmVkYWN0ZWQ8L2RzaWc6RXhwb25lbnQ+CiAgICAgICAgICAgICAgICA8L2RzaWc6UlNBS2V5VmFsdWU+CiAgICAgICAgICAgIDwvZHNpZzpLZXlWYWx1ZT4KICAgICAgICA8L2RzaWc6S2V5SW5mbz4KICAgIDwvZHNpZzpTaWduYXR1cmU+CiAgICA8c2FtbHA6U3RhdHVzPgogICAgICAgIDxzYW1scDpTdGF0dXNDb2RlIFZhbHVlPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6c3RhdHVzOlN1Y2Nlc3MiLz4KICAgIDwvc2FtbHA6U3RhdHVzPgogICAgPHNhbWw6QXNzZXJ0aW9uIHhtbG5zPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBJRD0icmVkYWN0ZWQiCiAgICAgICAgICAgICAgICAgICAgSXNzdWVJbnN0YW50PSIyMDIxLTAyLTE2VDA3OjU2OjIwLjg4NVoiIFZlcnNpb249IjIuMCI+CiAgICAgICAgPHNhbWw6SXNzdWVyPmh0dHBzOi8vbG9naW4ub3Nsby5rb21tdW5lLm5vL2F1dGgvcmVhbG1zL0FEPC9zYW1sOklzc3Vlcj4KICAgICAgICA8ZHNpZzpTaWduYXR1cmUgeG1sbnM6ZHNpZz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+CiAgICAgICAgICAgIDxkc2lnOlNpZ25lZEluZm8+CiAgICAgICAgICAgICAgICA8ZHNpZzpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+CiAgICAgICAgICAgICAgICA8ZHNpZzpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8+CiAgICAgICAgICAgICAgICA8ZHNpZzpSZWZlcmVuY2UgVVJJPSJyZWRhY3RlZCI+CiAgICAgICAgICAgICAgICAgICAgPGRzaWc6VHJhbnNmb3Jtcz4KICAgICAgICAgICAgICAgICAgICAgICAgPGRzaWc6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz4KICAgICAgICAgICAgICAgICAgICAgICAgPGRzaWc6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+CiAgICAgICAgICAgICAgICAgICAgPC9kc2lnOlRyYW5zZm9ybXM+CiAgICAgICAgICAgICAgICAgICAgPGRzaWc6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+CiAgICAgICAgICAgICAgICAgICAgPGRzaWc6RGlnZXN0VmFsdWU+cmVkYWN0ZWQ8L2RzaWc6RGlnZXN0VmFsdWU+CiAgICAgICAgICAgICAgICA8L2RzaWc6UmVmZXJlbmNlPgogICAgICAgICAgICA8L2RzaWc6U2lnbmVkSW5mbz4KICAgICAgICAgICAgPGRzaWc6U2lnbmF0dXJlVmFsdWU+CiAgICAgICAgICAgICAgICByZWRhY3RlZAogICAgICAgICAgICA8L2RzaWc6U2lnbmF0dXJlVmFsdWU+CiAgICAgICAgICAgIDxkc2lnOktleUluZm8+CiAgICAgICAgICAgICAgICA8ZHNpZzpLZXlOYW1lPnJlZGFjdGVkPC9kc2lnOktleU5hbWU+CiAgICAgICAgICAgICAgICA8ZHNpZzpYNTA5RGF0YT4KICAgICAgICAgICAgICAgICAgICA8ZHNpZzpYNTA5Q2VydGlmaWNhdGU+CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZGFjdGVkCiAgICAgICAgICAgICAgICAgICAgPC9kc2lnOlg1MDlDZXJ0aWZpY2F0ZT4KICAgICAgICAgICAgICAgIDwvZHNpZzpYNTA5RGF0YT4KICAgICAgICAgICAgICAgIDxkc2lnOktleVZhbHVlPgogICAgICAgICAgICAgICAgICAgIDxkc2lnOlJTQUtleVZhbHVlPgogICAgICAgICAgICAgICAgICAgICAgICA8ZHNpZzpNb2R1bHVzPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkYWN0ZWQKICAgICAgICAgICAgICAgICAgICAgICAgPC9kc2lnOk1vZHVsdXM+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkc2lnOkV4cG9uZW50PnJlZGFjdGVkPC9kc2lnOkV4cG9uZW50PgogICAgICAgICAgICAgICAgICAgIDwvZHNpZzpSU0FLZXlWYWx1ZT4KICAgICAgICAgICAgICAgIDwvZHNpZzpLZXlWYWx1ZT4KICAgICAgICAgICAgPC9kc2lnOktleUluZm8+CiAgICAgICAgPC9kc2lnOlNpZ25hdHVyZT4KICAgICAgICA8c2FtbDpTdWJqZWN0PgogICAgICAgICAgICA8c2FtbDpOYW1lSUQgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDp0cmFuc2llbnQiPgogICAgICAgICAgICAgICAgcmVkYWN0ZWQKICAgICAgICAgICAgPC9zYW1sOk5hbWVJRD4KICAgICAgICAgICAgPHNhbWw6U3ViamVjdENvbmZpcm1hdGlvbiBNZXRob2Q9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpjbTpiZWFyZXIiPgogICAgICAgICAgICAgICAgPHNhbWw6U3ViamVjdENvbmZpcm1hdGlvbkRhdGEgTm90T25PckFmdGVyPSIyMDIxLTAyLTE2VDA4OjAxOjE4Ljg4NVoiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWNpcGllbnQ9Imh0dHBzOi8vc2lnbmluLmF3cy5hbWF6b24uY29tL3NhbWwiLz4KICAgICAgICAgICAgPC9zYW1sOlN1YmplY3RDb25maXJtYXRpb24+CiAgICAgICAgPC9zYW1sOlN1YmplY3Q+CiAgICAgICAgPHNhbWw6Q29uZGl0aW9ucyBOb3RCZWZvcmU9IjIwMjEtMDItMTZUMDc6NTY6MTguODg1WiIgTm90T25PckFmdGVyPSIyMDIxLTAyLTE2VDA3OjU3OjE4Ljg4NVoiPgogICAgICAgICAgICA8c2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPgogICAgICAgICAgICAgICAgPHNhbWw6QXVkaWVuY2U+dXJuOmFtYXpvbjp3ZWJzZXJ2aWNlczwvc2FtbDpBdWRpZW5jZT4KICAgICAgICAgICAgPC9zYW1sOkF1ZGllbmNlUmVzdHJpY3Rpb24+CiAgICAgICAgPC9zYW1sOkNvbmRpdGlvbnM+CiAgICAgICAgPHNhbWw6QXV0aG5TdGF0ZW1lbnQgQXV0aG5JbnN0YW50PSIyMDIxLTAyLTE2VDA3OjU2OjIwLjg4NVoiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2Vzc2lvbkluZGV4PSJyZWRhY3RlZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXNzaW9uTm90T25PckFmdGVyPSIyMDIxLTAyLTE2VDE3OjU2OjIwLjg4NVoiPgogICAgICAgICAgICA8c2FtbDpBdXRobkNvbnRleHQ+CiAgICAgICAgICAgICAgICA8c2FtbDpBdXRobkNvbnRleHRDbGFzc1JlZj51cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3Nlczp1bnNwZWNpZmllZAogICAgICAgICAgICAgICAgPC9zYW1sOkF1dGhuQ29udGV4dENsYXNzUmVmPgogICAgICAgICAgICA8L3NhbWw6QXV0aG5Db250ZXh0PgogICAgICAgIDwvc2FtbDpBdXRoblN0YXRlbWVudD4KICAgICAgICA8c2FtbDpBdHRyaWJ1dGVTdGF0ZW1lbnQ+CiAgICAgICAgICAgIDxzYW1sOkF0dHJpYnV0ZSBGcmllbmRseU5hbWU9IlNlc3Npb24gRHVyYXRpb24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOYW1lPSJodHRwczovL2F3cy5hbWF6b24uY29tL1NBTUwvQXR0cmlidXRlcy9TZXNzaW9uRHVyYXRpb24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj4KICAgICAgICAgICAgICAgIDxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhtbG5zOnhzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhzaTp0eXBlPSJ4czpzdHJpbmciPjI4ODAwCiAgICAgICAgICAgICAgICA8L3NhbWw6QXR0cmlidXRlVmFsdWU+CiAgICAgICAgICAgIDwvc2FtbDpBdHRyaWJ1dGU+CiAgICAgICAgICAgIDxzYW1sOkF0dHJpYnV0ZSBGcmllbmRseU5hbWU9IlNlc3Npb24gUm9sZSIgTmFtZT0iaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9TQU1ML0F0dHJpYnV0ZXMvUm9sZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6YmFzaWMiPgogICAgICAgICAgICAgICAgPHNhbWw6QXR0cmlidXRlVmFsdWUgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIgeHNpOnR5cGU9InhzOnN0cmluZyI+CiAgICAgICAgICAgICAgICAgICAgYXJuOmF3czppYW06OjAwMDAwMDAwMDAwMDpyb2xlL29zbG9rb21tdW5lL2lhbWFkbWluLVNBTUwsYXJuOmF3czppYW06OjAwMDAwMDAwMDAwMDpzYW1sLXByb3ZpZGVyL2tleWNsb2FrCiAgICAgICAgICAgICAgICA8L3NhbWw6QXR0cmlidXRlVmFsdWU+CiAgICAgICAgICAgIDwvc2FtbDpBdHRyaWJ1dGU+CiAgICAgICAgICAgIDxzYW1sOkF0dHJpYnV0ZSBGcmllbmRseU5hbWU9IlNlc3Npb24gTmFtZSIgTmFtZT0iaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9TQU1ML0F0dHJpYnV0ZXMvUm9sZVNlc3Npb25OYW1lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgTmFtZUZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmF0dHJuYW1lLWZvcm1hdDpiYXNpYyI+CiAgICAgICAgICAgICAgICA8c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiB4c2k6dHlwZT0ieHM6c3RyaW5nIj4KICAgICAgICAgICAgICAgICAgICBvb28wMDAwMDAKICAgICAgICAgICAgICAgIDwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT4KICAgICAgICAgICAgPC9zYW1sOkF0dHJpYnV0ZT4KICAgICAgICAgICAgPHNhbWw6QXR0cmlidXRlIE5hbWU9IlJvbGUiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6YmFzaWMiPgogICAgICAgICAgICAgICAgPHNhbWw6QXR0cmlidXRlVmFsdWUgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIgeHNpOnR5cGU9InhzOnN0cmluZyI+CiAgICAgICAgICAgICAgICAgICAgYXJuOmF3czppYW06OjAwMDAwMDAwMDAwMDpyb2xlL29zbG9rb21tdW5lL2lhbWFkbWluLVNBTUwsYXJuOmF3czppYW06OjAwMDAwMDAwMDAwMDpzYW1sLXByb3ZpZGVyL2tleWNsb2FrCiAgICAgICAgICAgICAgICA8L3NhbWw6QXR0cmlidXRlVmFsdWU+CiAgICAgICAgICAgIDwvc2FtbDpBdHRyaWJ1dGU+CiAgICAgICAgPC9zYW1sOkF0dHJpYnV0ZVN0YXRlbWVudD4KICAgIDwvc2FtbDpBc3NlcnRpb24+Cjwvc2FtbHA6UmVzcG9uc2U+Cg==\n", nil
		},
	}
}
